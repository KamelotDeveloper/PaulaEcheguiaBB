---
const images = [
  "/1.webp",
  "/2.webp",
  "/3.webp",
  "/4.webp",
];
---

<!-- Carrusel sin fondo ni borde -->
<div class="relative overflow-hidden w-full flex flex-col items-center">
  <!-- Pista de imágenes -->
  <div
    id="carousel-track"
    class="flex transition-transform duration-700 ease-in-out w-full"
    style="transform: translateX(0%)"
  >
    {images.map((src) => (
      <div class="w-full flex-shrink-0 flex justify-center items-center">
        <img
          src={src}
          alt="Galería"
          class="max-h-80 w-auto object-contain"
        />
      </div>
    ))}
  </div>

  <!-- Dots de navegación manual -->
  <div id="carousel-dots" class="flex gap-2 mt-3">
    {images.map((_, i) => (
      <button
        class="h-2 w-2 rounded-full bg-gray-400 data-[active=true]:bg-[#d4ae6d] transition-colors"
        data-index={i}
        aria-label={`Ir a imagen ${i + 1}`}
      ></button>
    ))}
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const track = document.getElementById("carousel-track");
  const dots = document.querySelectorAll("#carousel-dots button");
  if (!track || !dots.length) return;

  const slides = track.children.length;
  let index = 0;
  let interval;

  function goToSlide(i) {
    index = (i + slides) % slides;
    track.style.transform = `translateX(-${index * 100}%)`;
    dots.forEach((d, idx) => d.dataset.active = idx === index);
  }

  function startAuto() {
    interval = setInterval(() => goToSlide(index + 1), 3000);
  }
  function stopAuto() {
    clearInterval(interval);
  }

  // Dots manuales
  dots.forEach((dot, i) => {
    dot.addEventListener("click", () => {
      stopAuto();
      goToSlide(i);
      startAuto();
    });
  });

  // Swipe en móvil
  let startX = 0;
  track.addEventListener("touchstart", e => {
    if (!e.touches?.[0]) return;
    stopAuto();
    startX = e.touches[0].clientX;
  });
  track.addEventListener("touchend", e => {
    if (!e.changedTouches?.[0]) return;
    const diff = startX - e.changedTouches[0].clientX;
    if (diff > 50) goToSlide(index + 1);
    else if (diff < -50) goToSlide(index - 1);
    startAuto();
  });

  goToSlide(0);
  startAuto();
});
</script>

